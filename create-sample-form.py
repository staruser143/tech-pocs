#!/usr/bin/env python3
"""
Generate a sample PDF form with AcroForm fields for testing the document generation system.
This creates an applicant information form with editable fields.

Requirements: pip install reportlab PyPDF2
"""

from reportlab.pdfgen import canvas
from reportlab.lib.pagesizes import letter
from reportlab.pdfbase import pdfform
from reportlab.lib.colors import black, blue, red
import os

def create_applicant_form(output_path):
    """Create a PDF form with applicant information fields"""
    
    # Create PDF canvas
    c = canvas.Canvas(output_path, pagesize=letter)
    width, height = letter
    
    # Title
    c.setFont("Helvetica-Bold", 20)
    c.drawString(50, height - 50, "Applicant Information Form")
    
    # Instructions
    c.setFont("Helvetica", 10)
    c.drawString(50, height - 75, "Please fill in your personal information below:")
    
    # Starting Y position for fields
    y_position = height - 120
    field_height = 30
    label_offset = 15
    
    # Helper function to create form fields
    def add_text_field(field_name, label, y_pos):
        # Draw label
        c.setFont("Helvetica-Bold", 11)
        c.drawString(50, y_pos + label_offset, label + ":")
        
        # Create text field
        form = c.acroForm
        form.textfield(
            name=field_name,
            tooltip=f"Enter your {label.lower()}",
            x=200,
            y=y_pos,
            width=300,
            height=20,
            borderColor=black,
            fillColor=None,
            textColor=blue,
            forceBorder=True
        )
    
    # Add form fields
    add_text_field("applicationId", "Application ID", y_position)
    y_position -= field_height
    
    add_text_field("primaryFirstName", "First Name", y_position)
    y_position -= field_height
    
    add_text_field("primaryLastName", "Last Name", y_position)
    y_position -= field_height
    
    add_text_field("primaryDob", "Date of Birth", y_position)
    y_position -= field_height

    y_position -= 10
    c.setFont("Helvetica-Bold", 14)
    c.drawString(50, y_position, "Spouse Information")
    y_position -= 30

    add_text_field("spouseFirstName", "Spouse First Name", y_position)
    y_position -= field_height
    add_text_field("spouseLastName", "Spouse Last Name", y_position)
    y_position -= field_height
    add_text_field("spouseDob", "Spouse Date of Birth", y_position)
    y_position -= field_height

    y_position -= 10
    c.setFont("Helvetica-Bold", 14)
    c.drawString(50, y_position, "Children Information")
    y_position -= 30

    for i in range(1, 4):
        add_text_field(f"childFirstName.{i}", f"Child {i} First Name", y_position)
        y_position -= field_height
        add_text_field(f"childLastName.{i}", f"Child {i} Last Name", y_position)
        y_position -= field_height
        add_text_field(f"childDob.{i}", f"Child {i} Date of Birth", y_position)
        y_position -= field_height
        y_position -= 10
    
    # Footer
    c.setFont("Helvetica", 9)
    c.drawString(50, 50, "Generated by Document Generation System - Test Template")
    c.drawString(50, 35, "All fields are editable and will be populated by the system.")
    
    # Save the PDF
    c.save()
    print(f"âœ“ PDF form created successfully: {output_path}")

if __name__ == "__main__":
    # Output path
    output_dir = "src/main/resources/templates/forms"
    os.makedirs(output_dir, exist_ok=True)
    output_file = os.path.join(output_dir, "applicant-form.pdf")
    
    print("Creating applicant form PDF...")
    create_applicant_form(output_file)
    
    print("\nForm fields created:")
    print("  - applicationId")
    print("  - primaryFirstName")
    print("  - primaryLastName")
    print("  - primaryDob")
    print("  - spouseFirstName")
    print("  - spouseLastName")
    print("  - spouseDob")
    print("  - childFirstName.1-3")
    print(f"\nFile location: {output_file}")
    print("\nYou can now test the document generation API!")
